# 数据库作业6

### 2

建立一个关于系、学生、班级、学会等诸信息的关系数据库。

描述学生的属性有：学号、姓名、出生年月、系名、班号、宿舍区； 

描述班级的属性有：班号、专业名、系名、人数、入校年份；

描述系的属性有：系名、系号、系办公室地点、人数；

描述学会的属性有：学会名、成立年份、地点、人数。

有关语义如下：一个系有若干专业，每个专业每年只招一个班，每个班有若干学生。一个系的学生住在同一宿舍区。每个学生可参加若干学会，每个学会有若干学生。学生参加某学会有一个入会年份。

请给出关系模式，写出每个关系模式的极小函数依赖集，指出是否存在传递函数依赖，对于函数依赖左部是多属性的情况，讨论函数依赖是完全函数依赖还是部分函数依赖。

指出各关系的候选码、外部码，并说明是否全码存在。



**关系模式**： 

学生（学号，姓名，出生年月，系名，班号，宿舍区）

班级（班号，专业名，系名，班级人数，入校年份）

系（系名，系号，系办公室地点，系人数）

学会（学会名，成立年份，学会地点，学会人数）

学会成员（学号，学会号，入会年份）

根据语义写出每个关系模式的**极小函数依赖集**：

学生：学号→姓名，学号→出生年月，学号→班号，学号→系名，学号→宿舍区

班级：班号→专业名，专业名→系名，班号→班级人数，班号→入校年份，（入校年份，专业名）→班号

系：系名→系号，系号→系名，系号→系办公室地点，系号→系人数

学会：学会名→成立年份，学会名→学会地点，学会名→学会人数

学会成员：（学号，学会名）→入会年份

学生关系中存在的**传递函数依赖**：

因为学号→班号，班号→系名，所以存在传递函数依赖学号→系名

因为班号→系名，系名→宿舍区，所以存在传递函数依赖班号→宿舍区

因为学号→班号，班号→系名，系名→宿舍区，所以存在传递函数依赖学号→宿舍区

班级关系中存在的**传递函数依赖**：

因为班号→专业名，专业名→宿舍区，所以存在传递函数依赖班号→宿舍区。

**函数依赖左部是多属性的情况**有：

（学号，学会名）→入会年份

（入校年份，专业名）→班号

都是完全函数依赖。

**各关系的候选码、外部码和全码**：

学生关系的候选码为学号，外部码为班号、系名。

班级关系的候选码为班号、（专业名，入校年份），外部码为系名。

系关系的候选码为系名、系号，无外部码。

学会关系的候选码为学会名，无外部码。

学会成员关系的候选码为（学号，学会名），外部码为学号、学会名。

以上关系均不存在全码。

### 补充题

1. 设有关系R（ABCDEG），其函数依赖集为：

F={E&rarr;D,C&rarr;B,CE&rarr;G,B&rarr;A}

请回答下列问题：

（1）R最高属于第几范式？

由于 $CE^+=(A,B,C,D,E,G)$，$C^+=(A,B,C)$，$E^+=(D,E)$，故CE为候选键。

显然$R \in 1NF$，对于非主属性B，存在部分函数依赖$C\rarr B$，故不属于第二范式。

因此R最高属于第一范式。

（2）分解R为3NF。

先求F的最小覆盖为：F

求得&sigma;={(E, D), (C, B), (C, E, G), (B, A)}

R的键为CE，可得&tau;={(E, D), (C, B), (C, E, G), (B, A), (C, E)}

去除重复关系后得：{(E, D), (C, B), (C, E, G), (B, A)}

（3）分解R为BCNF。

对于第（2）问分解后的关系模式中，任意一个非平凡函数依赖X&rarr;A，都有X是超键，因此已经属于BCNF。

（4）请验证&rho;={R1(DE),R2(BC),R3(CEG),R4(AB)}是否是R的一个无损分解。

建立如下表格：

|      | A        | B        | C        | D        | E        | G        |
| ---- | -------- | -------- | -------- | -------- | -------- | -------- |
| DE   | $b_{11}$ | $b_{12}$ | $b_{13}$ | $a_{4}$ | $a_{5}$ | $b_{16}$ |
| BC   | $b_{21}$ | $a_{2}$ | $a_{3}$ | $b_{24}$ | $b_{25}$ | $b_{26}$ |
| CEG  | $b_{31}$ | $b_{32}$ | $a_{3}$ | $b_{34}$ | $a_{5}$ | $a_{6}$ |
| AB   | $a_{1}$ | $a_{2}$ | $b_{43}$ | $b_{44}$ | $b_{45}$ | $b_{46}$ |

对每一个函数依赖进行变换后得到：

|      | A        | B        | C        | D        | E        | G        |
| ---- | -------- | -------- | -------- | -------- | -------- | -------- |
| DE   | $b_{11}$ | $b_{12}$ | $b_{13}$ | $a_{4}$  | $a_{5}$  | $b_{16}$ |
| BC   | $a_{1}$  | $a_{2}$  | $a_{3}$  | $b_{24}$ | $b_{25}$ | $b_{26}$ |
| CEG  | $a_{1}$  | $a_{2}$  | $a_{3}$  | $a_{4}$  | $a_{5}$  | $a_{6}$  |
| AB   | $a_{1}$  | $a_{2}$  | $b_{43}$ | $b_{44}$ | $b_{45}$ | $b_{46}$ |

由上表可知&rho;是无损分解。

2. 试问下列关系模式最高属于第几范式,并解释原因。

  1) R(ABCD),F＝{B->D,AB->C}。

存在部分函数依赖B&rarr;D，因此最高属于第一范式。

  2) R(ABCDE),F＝{AB->CE,E->AB,C->D}。

存在非主属性之间的依赖关系C&rarr;D，因此最高属于第二范式。

  3) R(ABC),F＝{ A->B,B->A,A->C }。

主属性为：A，B

非主属性为：C

候选键：A，B

满足实体完整性定义，符合第一范式。

满足所有的非主属性都完全依赖于一个候选键，符合第二范式。

满足不存在非主属性之间的依赖关系，符合第三范式。

满足对任意关系X&rarr;A中，X均为超键，符合BC范式。

因此最高为BC范式。



















