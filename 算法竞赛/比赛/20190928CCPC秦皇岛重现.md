# 20190928CCPC秦皇岛重现
[PDF题目](_v_attachments/20190928182217558_8147/CCPC2019-QHD-ProblemSet.pdf)  


|                    <br>                     |  <br>  |                                                  <br>                                                  |            <br>             |
| ------------------------------------------- | ------ | ------------------------------------------------------------------------------------------------------ | --------------------------- |
| Solved                                      | Pro.ID | Title                                                                                                  | Ratio(Accepted / Submitted) |
|                                             | 1001   | [Angle Beats](http://acm.hdu.edu.cn/contests/contest_showproblem.php?pid=1001&cid=872)                 | 5.68%(58/1022)              |
|                                             | 1002   | [The Tree of Haruhi Suzumiya](http://acm.hdu.edu.cn/contests/contest_showproblem.php?pid=1002&cid=872) | 50.00%(1/2)                 |
|                                             | 1003   | [Sakurada Reset](http://acm.hdu.edu.cn/contests/contest_showproblem.php?pid=1003&cid=872)              | 0.00%(0/0)                  |
|  ![](_v_images/20190928182025555_6064.gif)  | 1004   | [Decimal](http://acm.hdu.edu.cn/contests/contest_showproblem.php?pid=1004&cid=872)                     | 42.92%(1012/2358)           |
|                                             | 1005   | [Escape](http://acm.hdu.edu.cn/contests/contest_showproblem.php?pid=1005&cid=872)                      | 24.54%(53/216)              |
|                                             | 1006   | [Forest Program](http://acm.hdu.edu.cn/contests/contest_showproblem.php?pid=1006&cid=872)              | 10.76%(334/3105)            |
|                                             | 1007   | [Game on Chessboard](http://acm.hdu.edu.cn/contests/contest_showproblem.php?pid=1007&cid=872)          | 7.95%(7/88)                 |
|                                             | 1008   | [Houraisan Kaguya](http://acm.hdu.edu.cn/contests/contest_showproblem.php?pid=1008&cid=872)            | 0.00%(0/71)                 |
|  ![](_v_images/20190928182025451_18386.gif) | 1009   | [Invoker](http://acm.hdu.edu.cn/contests/contest_showproblem.php?pid=1009&cid=872)                     | 21.31%(322/1511)            |
|  ![](_v_images/20190928182025346_31288.gif) | 1010   | [MUV LUV EXTRA](http://acm.hdu.edu.cn/contests/contest_showproblem.php?pid=1010&cid=872)               | 19.15%(348/1817)            |
|                                             | 1011   | [MUV LUV UNLIMITED](http://acm.hdu.edu.cn/contests/contest_showproblem.php?pid=1011&cid=872)           | 14.79%(54/365)              |
|                                             | 1012   | [MUV LUV ALTERNATIVE](http://acm.hdu.edu.cn/contests/contest_showproblem.php?pid=1012&cid=872)         | 25.00%(6/24)                |

题库链接：
| <br> | <br> | <br> | <br> | <br> | <br> |
| --- | --- | --- | --- | --- | --- |
|   | 6731 | [Angle Beats](http://acm.hdu.edu.cn/showproblem.php?pid=6731) | [](http://acm.hdu.edu.cn/search.php?field=problem&key=&author=1&searchmode=author) | [642ccpcQHD](http://acm.hdu.edu.cn/search.php?field=problem&key=642ccpcQHD&source=1&searchmode=source) | ([4](http://acm.hdu.edu.cn/status.php?pid=6731&status=5)/[16](http://acm.hdu.edu.cn/status.php?pid=6731))25.00% |
|   | 6732 | [The Tree of Haruhi Suzumiya](http://acm.hdu.edu.cn/showproblem.php?pid=6732) | [](http://acm.hdu.edu.cn/search.php?field=problem&key=&author=1&searchmode=author) | [642ccpcQHD](http://acm.hdu.edu.cn/search.php?field=problem&key=642ccpcQHD&source=1&searchmode=source) | ([1](http://acm.hdu.edu.cn/status.php?pid=6732&status=5)/[1](http://acm.hdu.edu.cn/status.php?pid=6732))100.00% |
|   | 6733 | [Sakurada Reset](http://acm.hdu.edu.cn/showproblem.php?pid=6733) | [](http://acm.hdu.edu.cn/search.php?field=problem&key=&author=1&searchmode=author) | [642ccpcQHD](http://acm.hdu.edu.cn/search.php?field=problem&key=642ccpcQHD&source=1&searchmode=source) | ([0](http://acm.hdu.edu.cn/status.php?pid=6733&status=5)/[0](http://acm.hdu.edu.cn/status.php?pid=6733))0.00% |
|   | 6734 | [Decimal](http://acm.hdu.edu.cn/showproblem.php?pid=6734) | [](http://acm.hdu.edu.cn/search.php?field=problem&key=&author=1&searchmode=author) | [642ccpcQHD](http://acm.hdu.edu.cn/search.php?field=problem&key=642ccpcQHD&source=1&searchmode=source) | ([6](http://acm.hdu.edu.cn/status.php?pid=6734&status=5)/[9](http://acm.hdu.edu.cn/status.php?pid=6734))66.67% |
|   | 6735 | [Escape](http://acm.hdu.edu.cn/showproblem.php?pid=6735) | [](http://acm.hdu.edu.cn/search.php?field=problem&key=&author=1&searchmode=author) | [642ccpcQHD](http://acm.hdu.edu.cn/search.php?field=problem&key=642ccpcQHD&source=1&searchmode=source) | ([3](http://acm.hdu.edu.cn/status.php?pid=6735&status=5)/[3](http://acm.hdu.edu.cn/status.php?pid=6735))100.00% |
|   | 6736 | [Forest Program](http://acm.hdu.edu.cn/showproblem.php?pid=6736) | [](http://acm.hdu.edu.cn/search.php?field=problem&key=&author=1&searchmode=author) | [642ccpcQHD](http://acm.hdu.edu.cn/search.php?field=problem&key=642ccpcQHD&source=1&searchmode=source) | ([10](http://acm.hdu.edu.cn/status.php?pid=6736&status=5)/[22](http://acm.hdu.edu.cn/status.php?pid=6736))45.45% |
|   | 6737 | [Game on Chessboard](http://acm.hdu.edu.cn/showproblem.php?pid=6737) | [](http://acm.hdu.edu.cn/search.php?field=problem&key=&author=1&searchmode=author) | [642ccpcQHD](http://acm.hdu.edu.cn/search.php?field=problem&key=642ccpcQHD&source=1&searchmode=source) | ([2](http://acm.hdu.edu.cn/status.php?pid=6737&status=5)/[11](http://acm.hdu.edu.cn/status.php?pid=6737))18.18% |
|   | 6738 | [Houraisan Kaguya](http://acm.hdu.edu.cn/showproblem.php?pid=6738) | [](http://acm.hdu.edu.cn/search.php?field=problem&key=&author=1&searchmode=author) | [642ccpcQHD](http://acm.hdu.edu.cn/search.php?field=problem&key=642ccpcQHD&source=1&searchmode=source) | ([2](http://acm.hdu.edu.cn/status.php?pid=6738&status=5)/[5](http://acm.hdu.edu.cn/status.php?pid=6738))40.00% |
|   | 6739 | [Invoker](http://acm.hdu.edu.cn/showproblem.php?pid=6739) | [](http://acm.hdu.edu.cn/search.php?field=problem&key=&author=1&searchmode=author) | [642ccpcQHD](http://acm.hdu.edu.cn/search.php?field=problem&key=642ccpcQHD&source=1&searchmode=source) | ([3](http://acm.hdu.edu.cn/status.php?pid=6739&status=5)/[13](http://acm.hdu.edu.cn/status.php?pid=6739))23.08% |
|   | 6740 | [MUV LUV EXTRA](http://acm.hdu.edu.cn/showproblem.php?pid=6740) | [](http://acm.hdu.edu.cn/search.php?field=problem&key=&author=1&searchmode=author) | [642ccpcQHD](http://acm.hdu.edu.cn/search.php?field=problem&key=642ccpcQHD&source=1&searchmode=source) | ([10](http://acm.hdu.edu.cn/status.php?pid=6740&status=5)/[22](http://acm.hdu.edu.cn/status.php?pid=6740))45.45% |
|   | 6741 | [MUV LUV UNLIMITED](http://acm.hdu.edu.cn/showproblem.php?pid=6741) | [](http://acm.hdu.edu.cn/search.php?field=problem&key=&author=1&searchmode=author) | [642ccpcQHD](http://acm.hdu.edu.cn/search.php?field=problem&key=642ccpcQHD&source=1&searchmode=source) | ([3](http://acm.hdu.edu.cn/status.php?pid=6741&status=5)/[4](http://acm.hdu.edu.cn/status.php?pid=6741))75.00% |
|   | 6742 | [MUV LUV ALTERNATIVE](http://acm.hdu.edu.cn/showproblem.php?pid=6742) | [](http://acm.hdu.edu.cn/search.php?field=problem&key=&author=1&searchmode=author) | [642ccpcQHD](http://acm.hdu.edu.cn/search.php?field=problem&key=642ccpcQHD&source=1&searchmode=source) | ([1](http://acm.hdu.edu.cn/status.php?pid=6742&status=5)/[1](http://acm.hdu.edu.cn/status.php?pid=6742))100.00% |

## Forest Program

****Time Limit: 2000/1000 MS (Java/Others)    Memory Limit: 131072/131072 K (Java/Others)  
Total Submission(s): 22    Accepted Submission(s): 10****  
  
  

Problem Description

The kingdom of Z is fighting against desertification these years since there are plenty of deserts in its wide and huge territory. The deserts are too arid to have rainfall or human habitation, and the only creatures that can live inside the deserts are the cactuses. In this problem, a cactus in desert can be represented by a cactus in graph theory.  
In graph theory, a cactus is a connected undirected graph with no self-loops and no multi-edges, and each edge can only be in at most one simple cycle. While a tree in graph theory is a connected undirected acyclic graph. So here comes the idea: just remove some edges in these cactuses so that the remaining connected components all become trees. After that, the deserts will become forests, which can halt desertification fundamentally.  
Now given an undirected graph with n vertices and m edges satisfying that all connected components are cactuses, you should determine the number of schemes to remove edges in the graph so that the remaining connected components are all trees. Print the answer modulo 998244353.  
Two schemes are considered to be different if and only if the sets of removed edges in two schemes are different.

  

Input

The first line contains two non-negative integers n, m (1 ≤ n ≤ 300 000, 0 ≤ m ≤ 500 000), denoting the number of vertices and the number of edges in the given graph.  
Next m lines each contains two positive integers u, v (1 ≤ u, v ≤ n, u = v), denoting that vertices u and v are connected by an undirected edge.  
It is guaranteed that each connected component in input graph is a cactus.

  

Output

Output a single line containing a non-negative integer, denoting the answer modulo 998244353.

  

Sample Input

3 3
1 2
2 3
3 1
6 6
1 2
2 3
3 1
2 4
4 5
5 2

  

Sample Output

7
49

  

Source

[642ccpcQHD](http://acm.hdu.edu.cn/search.php?field=problem&key=642ccpcQHD&source=1&searchmode=source)

  

Recommend

chendu   |   We have carefully selected several similar problems for you:  [6742](http://acm.hdu.edu.cn/showproblem.php?pid=6742) [6741](http://acm.hdu.edu.cn/showproblem.php?pid=6741) [6740](http://acm.hdu.edu.cn/showproblem.php?pid=6740) [6739](http://acm.hdu.edu.cn/showproblem.php?pid=6739) [6738](http://acm.hdu.edu.cn/showproblem.php?pid=6738) 

  

[Statistic](http://acm.hdu.edu.cn/statistic.php?pid=6736) | [Submit](http://acm.hdu.edu.cn/submit.php?pid=6736) | [Discuss](http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6736) | [Note](http://acm.hdu.edu.cn/note/note.php?pid=6736)

## View Code

